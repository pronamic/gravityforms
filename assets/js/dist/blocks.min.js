!function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function o(e,t){return o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},o(e,t)}function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function a(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return r(e)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}var i=React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 508.3 559.5",width:"100%",height:"100%",focusable:"false","aria-hidden":"true",className:"dashicon dashicon-gravityforms"},React.createElement("g",null,React.createElement("path",{className:"st0",d:"M468,109.8L294.4,9.6c-22.1-12.8-58.4-12.8-80.5,0L40.3,109.8C18.2,122.6,0,154,0,179.5V380\tc0,25.6,18.1,56.9,40.3,69.7l173.6,100.2c22.1,12.8,58.4,12.8,80.5,0L468,449.8c22.2-12.8,40.3-44.2,40.3-69.7V179.6\tC508.3,154,490.2,122.6,468,109.8z M399.3,244.4l-195.1,0c-11,0-19.2,3.2-25.6,10c-14.2,15.1-18.2,44.4-19.3,60.7H348v-26.4h49.9\tv76.3H111.3l-1.8-23c-0.3-3.3-5.9-80.7,32.8-121.9c16.1-17.1,37.1-25.8,62.4-25.8h194.7V244.4z"})));function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=l(e);if(t){var n=l(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return a(this,r)}}var s=wp.components,m=s.PanelBody,f=s.Placeholder,u=s.SelectControl,p=s.TextControl,d=s.TextareaControl,g=s.ToggleControl,b=s.ToolbarButton,y=s.Tooltip,v=wp.hasOwnProperty("blockEditor")?wp.blockEditor:wp.editor,h=v.InspectorControls,k=v.BlockControls,_=wp.element,w=_.Component,R=_.Fragment,E=wp.i18n.__,C=wp.url.addQueryArgs,F=wp.components.ServerSideRender;wp.hasOwnProperty("serverSideRender")&&(F=wp.serverSideRender);var P=function(n){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o(e,t)}(_,n);var a,l,s,v=c(_);function _(){var t;e(this,_),(t=v.apply(this,arguments)).state={formWasDeleted:!1},t.setFormId=t.setFormId.bind(r(t));var o=t.props.attributes.formId;if(!o&&t.queryToJson().gfAddBlock&&(o=t.queryToJson().gfAddBlock,t.props.setAttributes({formId:o})),o){var n=_.getForm(o);n?n&&n.hasConditionalLogic&&t.props.setAttributes({formPreview:!1}):(t.props.setAttributes({formId:""}),t.state={formWasDeleted:!0})}return t}return a=_,s=[{key:"getForm",value:function(e){return gform_block_form.forms.find((function(t){return t.id==e}))}},{key:"getFormOptions",value:function(){for(var e=[{label:E("Select a Form","gravityforms"),value:""}],t=0;t<gform_block_form.forms.length;t++){var r=gform_block_form.forms[t];e.push({label:r.title,value:r.id})}return e}}],(l=[{key:"componentWillUnmount",value:function(){this.unmounting=!0}},{key:"setFormId",value:function(e){var t=_.getForm(e);this.props.setAttributes({formId:e}),this.setState({formWasDeleted:!1}),t&&t.hasConditionalLogic&&this.props.setAttributes({formPreview:!1})}},{key:"queryToJson",value:function(){var e=window.location.search.slice(1),t=e.length?e.split("&"):[],r={},o=[];return t.forEach((function(e){o=e.split("="),r[o[0]]=decodeURIComponent(o[1]||"")})),JSON.parse(JSON.stringify(r))}},{key:"openAdminPage",value:function(e,t){e.preventDefault();var r=C(gform_block_form.adminURL,t);window.open(r,"_blank","noopener")}},{key:"externalControls",value:function(){var e=this,t=this.props.attributes.formId;if(!t)return null;var r={page:"gf_edit_forms",id:t},o={page:"gf_edit_forms",id:t,view:"settings"};return React.createElement(k,{key:"gform-block-custom-controls"},React.createElement(b,{key:"gform-block-edit-form-buttton",title:E("Edit Form","gravityforms"),onClick:function(t){e.openAdminPage(t,r)},className:"gform-block__toolbar-button"},React.createElement(y,{text:E("Edit Form","gravityforms")},React.createElement("i",{className:"gform-icon gform-icon--create"}))),React.createElement(b,{key:"gform-block-form-settings-button",label:E("Form Settings","gravityforms"),title:E("Form Settings","gravityforms"),onClick:function(t){e.openAdminPage(t,o)},className:"gform-block__toolbar-button"},React.createElement(y,{text:E("Form Settings","gravityforms")},React.createElement("i",{className:"gform-icon gform-icon--cog"}))))}},{key:"render",value:function(){var e=this,t=this.props.attributes,r=t.formId,o=t.title,n=t.description,a=t.ajax,l=t.tabindex,c=t.formPreview,s=t.fieldValues,b=t.imgPreview,y=this.props,v=y.setAttributes,k=y.isSelected;if(b)return React.createElement(R,null,React.createElement("img",{src:gform_block_form.preview,style:{margin:"0 auto",display:"block"}}));var w=[this.externalControls(),k&&gform_block_form.forms&&gform_block_form.forms.length>0&&React.createElement(h,{key:"inspector"},React.createElement(m,{title:E("Form Settings","gravityforms")},React.createElement(u,{label:E("Form","gravityforms"),value:r,options:_.getFormOptions(),onChange:this.setFormId}),r&&React.createElement(g,{label:E("Form Title","gravityforms"),checked:o,onChange:function(){return v({title:!o})}}),r&&React.createElement(g,{label:E("Form Description","gravityforms"),checked:n,onChange:function(){return v({description:!n})}})),r&&React.createElement(m,{title:E("Advanced","gravityforms"),initialOpen:!1,className:"gform-block__panel"},r&&!_.getForm(r).hasConditionalLogic&&React.createElement(g,{label:E("Preview","gravityforms"),checked:c,onChange:function(){return v({formPreview:!c})}}),React.createElement(g,{label:E("AJAX","gravityforms"),checked:a,onChange:function(){return v({ajax:!a})}}),React.createElement(d,{label:E("Field Values","gravityforms"),value:s,onChange:function(e){v({fieldValues:e})}}),React.createElement(p,{className:"gform-block__tabindex",label:E("Tabindex","gravityforms"),type:"number",value:l,onChange:function(e){return v({tabindex:e})},placeholder:"-1"}),React.createElement(R,null,"Form ID: ",r)))];return r&&c?[w,React.createElement(F,{key:"form_preview",block:"gravityforms/form",attributes:this.props.attributes})]:[w,this.state.formWasDeleted&&React.createElement("div",{className:"gform-block__alert gform-block__alert-error"},React.createElement("p",null,E("The selected form has been deleted or trashed. Please select a new form.","gravityforms"))),React.createElement(f,{key:"placeholder",className:"wp-block-embed gform-block__placeholder"},React.createElement("div",{className:"gform-block__placeholder-brand"},React.createElement("div",{className:"gform-icon"},i),React.createElement("p",null,React.createElement("strong",null,"Gravity Forms"))),gform_block_form.forms&&gform_block_form.forms.length>0&&React.createElement("form",null,React.createElement("select",{value:r,onChange:function(t){return e.setFormId(t.target.value)}},_.getFormOptions().map((function(e){return React.createElement("option",{key:e.value,value:e.value},e.label)})))),(!gform_block_form.forms||gform_block_form.forms&&0===gform_block_form.forms.length)&&React.createElement("form",null,React.createElement("p",null,E("You must have at least one form to use the block.","gravityforms"))))]}}])&&t(a.prototype,l),s&&t(a,s),Object.defineProperty(a,"prototype",{writable:!1}),_}(w),x=P,S=wp.i18n.__;(0,wp.blocks.registerBlockType)("gravityforms/form",{title:S("Gravity Forms","gravityforms"),description:S("Select and display one of your forms.","gravityforms"),category:"embed",supports:{customClassName:!1,className:!1,html:!1},keywords:["gravity forms","newsletter","contact"],example:{attributes:{imgPreview:!0}},attributes:{formId:{type:"string"},title:{type:"boolean",default:!0},description:{type:"boolean",default:!0},ajax:{type:"boolean",default:!1},tabindex:{type:"string"},fieldValues:{type:"string"},formPreview:{type:"boolean",default:!0},imgPreview:{type:"boolean",default:!1}},icon:i,transforms:{from:[{type:"shortcode",tag:["gravityform","gravityforms"],attributes:{formId:{type:"string",shortcode:function(e){var t=e.named.id;return parseInt(t).toString()}},title:{type:"boolean",shortcode:function(e){return"true"===e.named.title}},description:{type:"boolean",shortcode:function(e){return"true"===e.named.description}},ajax:{type:"boolean",shortcode:function(e){return"true"===e.named.ajax}},tabindex:{type:"string",shortcode:function(e){var t=e.named.tabindex;return isNaN(t)?null:parseInt(t).toString()}}}}]},edit:x,save:function(){return null}})}();