"use strict";(self.webpackChunkgravityforms=self.webpackChunkgravityforms||[]).push([[157],{1475:function(e,t,n){n.r(t),n.d(t,{default:function(){return E}});var r=n(5798),i=n(8134),c=n(455),o=n(9280),u=n.n(o),a=n(3771),d=n(1295),p=function(e){return(0,r.getNodes)(".gfield--type-product",!0,e,!0)},l=function(e,t){if(!t)return[];if(g(t))return[];var n=[],i="",c="",o=null,u=null,a=null,p=v(t);switch(m(t)){case"select":u=(0,r.getNode)("select",t,!0),o=h(u.value),n.push({id:p,name:o.name,price:o.price});break;case"radio":(a=(0,r.getNodes)("input",!0,t,!0).find(function(e){return e.checked}))&&(o=h(a.value),n.push({id:p,name:o.name,price:o.price}));break;case"checkbox":(0,r.getNodes)('input[type="checkbox"]:checked',!0,t,!0).forEach(function(e){o=h(e.value),n.push({id:p,name:o.name,price:o.price})});break;case"hiddenproduct":case"calculation":case"singleproduct":i=(0,r.getNode)('input[name="input_'.concat(p,'.1"]'),t,!0).value,c=(0,d.Ro)((0,r.getNode)('input[name="input_'.concat(p,'.2"]'),t,!0).value),n.push({id:p,name:i,price:c});break;case"singleshipping":case"price":c=(0,d.Ro)((0,r.getNode)('input[name="input_'.concat(p,'"]'),t,!0).value||"0"),i=f(t),n.push({id:p,name:i,price:c})}return n},s=function(e,t){var n=v(t),i=(0,r.getNode)(".gfield_quantity_".concat(e.dataset.formid,"_").concat(n),e,!0),c=i?(0,r.getNode)("input, select",i,!0):(0,r.getNode)(".ginput_quantity",t,!0);return c?c.value?parseFloat(c.value):0:1},f=function(e){var t=(0,r.getNode)(".gfield_label",e,!0);return t?t.innerText:""},g=function(e){if("hidden"===e.dataset.conditionalLogic)return!0;var t=e.closest(".gform_page");return!(!t||"hidden"!==t.dataset.conditionalLogic)},h=function(e){if(!e)return{name:null,price:null};var t=e.split("|");return{name:t[0],price:t.length>1?(0,d.Ro)(t[1]):null}},m=function(e){var t="gfield--input-type-",n=(0,i.A)(e.classList).find(function(e){return e.startsWith(t)});return n?n.replace(t,""):""},v=function(e){return e.id.split("_")[2]},_=function(e){var t=e.target.closest(".gform_wrapper form").dataset.formid,n=v(e.target),i=e.target;(0,r.trigger)({event:"gform/products/product_field_changed",data:{event:e,formId:t,productFieldId:n,htmlInput:i},native:!1}),y(t)},y=function(){var e=(0,c.A)(u().mark(function e(t){var n,i,c,o;return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(0,r.getNode)("#gform_".concat(t),document,!0)){e.next=3;break}return e.abrupt("return");case 3:return i={products:[]},p(n).forEach(function(e){var t=l(0,e);if(0!==t.length){var r=t[0];r.quantity=s(n,e),r.options=b(n,e),i.products.push(r)}}),(c=k(n))&&(i.shipping=c),e.next=10,(0,r.filter)({event:"gform/products/product_changed",data:{formId:t,products:i}});case 10:o=e.sent,i=o.products,t=o.formId,a.hZ(t,"products",i);case 14:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),k=function(e){var t=function(e){return(0,r.getNode)(".gfield--type-shipping",e,!0)}(e);if(!t)return null;var n=l(0,t);return n.length>0?n[0]:null},b=function(e,t){var n=[],c=function(e,t){var n=v(t);return(0,r.getNodes)(".gfield_option_".concat(e.dataset.formid,"_").concat(n),!0,e,!0)}(e,t);return c.forEach(function(e){var t=l(0,e);0!==t.length&&(t.forEach(function(t){t.field_label=f(e)}),n.push.apply(n,(0,i.A)(t)))}),n};window.gform.products={getPaymentAmount:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=a.Jt(e,"products");if(0===(null==r||null===(t=r.products)||void 0===t?void 0:t.length))return 0;for(var i=0,c=0;c<r.products.length;c++){for(var o=r.products[c],u=o.price,d=0;d<o.options.length;d++)u+=o.options[d].price;if(u*=o.quantity,n&&parseFloat(n)===parseFloat(o.id))return u;i+=u}return n?0:(r.shipping&&(i+=r.shipping.price),r.discount&&(i-=r.discount),i)},handleConditionalLogicExecuted:function(e){var t=e.detail.formId;y(t)},handleProductChange:_,updateProducts:y};var N=n(428),x=n.n(N),I=function(){document.addEventListener("gform/conditionalLogic/applyRules/end",function(e){y(e.detail.formId)}),document.addEventListener("gform/frontend_pages/evaluated",function(e){y(e)}),w("input",'.gfield_price input[type="text"], .gfield_price input[type="number"]',_),w("change",'.gfield_price input[type="text"], .gfield_price input[type="number"]',_),w("change",".ginput_calculated_price",_),w("click",'.gfield_price input[type="radio"], .gfield_price input[type="checkbox"]',_),x()(document).on("change",".gfield_price select",_)},w=function(e,t,n){document.addEventListener(e,function(e){e.target.closest(t)&&n.call(e.target,e)})},E=function(e){y(e),I(),(0,r.consoleInfo)("Gravity Forms Theme: Initialized product field.")}}}]);